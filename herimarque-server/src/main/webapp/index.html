<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.js"></script>
<script type="text/javascript" src="admincookie.js"></script>
<title>Herimarque Admin Page</title>
<style type="text/css">
.none { display:none; }
</style>
</head>
<body>
<h1>Herimarque admin page</h1>
<div class="adminLogin">
Please, Log-in<br>
id:<input type="text" id="adminId"><br>
password:<input type="password" id="adminPwd"><br>
<button id="login">Login</button>
</div>
<div class="admin">
<h2>관리자님, 환영합니다</h2>
<button id="contents">지도 관리</button>
<button id="users">사용자 관리</button>
<input type="button" id="notice" value="공지사항관리" />
<input type="button" id="db" value="데이터관리" />
</div>
</body>
<script type="text/javascript">
window.onload = function()
{
	$(".admin").addClass("none");
	
	//check cookie then if there is the cookie, set logined
	var admin = getCookie("admin");
	console.log(admin);
	if(admin != null && admin.length > 0){
		$(".admin").removeClass("none");
		$(".adminLogin").addClass("none");
		$("h2").html(admin + "관리자님 환영합니다.");
	}
}

$("#login").click(function(){
	$.ajax({
		type:'GET',
		url:'api/u/admin/login',
		beforeSend:function(xhr){
			xhr.setRequestHeader("user", $("#adminId").val());
			xhr.setRequestHeader("pwd", $("#adminPwd").val());
		},
		success:function(){
			$(".admin").removeClass("none");
			$(".adminLogin").addClass("none");
			$("h2").html($("#adminId").val() + "관리자님 환영합니다.");
		 	var exdate = new Date();
		 	console.log(exdate.toUTCString());
		 	exdate.setHours(exdate.getHours()+1);
			var value = "admin="+ $("#adminId").val() + "; expires="+exdate.toUTCString();
			document.cookie = value;
		},
	});
});
$("#contents").click(function(){
	location.href="contents.html";
});
$("#users").click(function(){
	location.href="users.html";
});
$("#notice").click(function(){
	location.href="notice.html";
});
$("#db").click(function(){
	location.href='db.html';
});
</script>
</html>